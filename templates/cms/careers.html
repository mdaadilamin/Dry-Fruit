{% extends 'base.html' %}
{% load static cms_extras %}

{% block title %}{{ page.title }} - DRY FRUITS DELIGHT{% endblock %}
{% block meta_description %}{{ page.meta_description|default:"Join our team at Dry Fruit House. We're looking for passionate professionals to help revolutionize the dry fruits industry." }}{% endblock %}

{% block content %}
<!-- Hero Section -->
{% for section in careers_sections %}
  {% if section.section_type == 'hero' and section.is_active %}
  <section class="py-5 bg-primary text-white">
      <div class="container">
          <div class="row">
              <div class="col-lg-8 mx-auto text-center">
                  <h1 class="display-4 fw-bold mb-4">{{ section.title|default:page.title }}</h1>
                  <p class="lead">{{ section.subtitle|default:"Join our mission to deliver premium quality dry fruits and nuts from farms around the world directly to your doorstep." }}</p>
                  <div class="mt-4">
                      <a href="#openings" class="btn btn-light btn-lg me-3">
                          <i data-lucide="briefcase" class="me-2"></i>View Openings
                      </a>
                      <a href="#culture" class="btn btn-outline-light btn-lg">
                          <i data-lucide="heart" class="me-2"></i>Our Culture
                      </a>
                  </div>
              </div>
          </div>
      </div>
  </section>
  {% endif %}
{% endfor %}

<!-- Main Content Section -->
<section class="py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <div class="bg-white rounded-3 shadow-sm p-5">
                    <!-- Introduction -->
                    <div class="page-content mb-5">
                        {{ page.content|safe }}
                    </div>
                    
                    <!-- Company Culture -->
                    {% for section in careers_sections %}
                      {% if section.section_type == 'culture' and section.is_active %}
                      <div id="culture" class="mb-5">
                          <h2 class="display-6 fw-bold mb-4 text-center">{{ section.title|default:"Our Culture" }}</h2>
                          <div class="row">
                              {% for item in culture_items %}
                                {% if item.is_active %}
                                <div class="col-md-6 mb-4">
                                    <div class="d-flex">
                                        <div class="feature-icon bg-primary bg-opacity-10 rounded-circle p-3 me-3">
                                            <i data-lucide="{{ item.icon_name }}" class="text-primary"></i>
                                        </div>
                                        <div>
                                            <h5 class="fw-bold">{{ item.title }}</h5>
                                            <p class="text-muted">{{ item.description }}</p>
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                              {% endfor %}
                          </div>
                      </div>
                      {% endif %}
                    {% endfor %}
                    
                    <!-- Employee Testimonials -->
                    {% for section in careers_sections %}
                      {% if section.section_type == 'testimonials' and section.is_active %}
                      <div class="mb-5">
                          <h2 class="display-6 fw-bold mb-4 text-center">{{ section.title|default:"What Our Team Says" }}</h2>
                          <div class="row">
                              {% for testimonial in testimonials %}
                                {% if testimonial.is_active %}
                                <div class="col-md-4 mb-4">
                                    <div class="card h-100 border-0 shadow-sm">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center mb-3">
                                                <div class="bg-light rounded-circle d-flex align-items-center justify-content-center me-3" style="width: 50px; height: 50px;">
                                                    <i data-lucide="user" class="text-muted"></i>
                                                </div>
                                                <div>
                                                    <h6 class="mb-0">{{ testimonial.name }}</h6>
                                                    <small class="text-muted">{{ testimonial.position }}</small>
                                                </div>
                                            </div>
                                            <p class="card-text">"{{ testimonial.testimonial }}"</p>
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                              {% endfor %}
                          </div>
                      </div>
                      {% endif %}
                    {% endfor %}
                    
                    <!-- Benefits Section -->
                    {% for section in careers_sections %}
                      {% if section.section_type == 'benefits' and section.is_active %}
                      <div class="mb-5">
                          <h2 class="display-6 fw-bold mb-4 text-center">{{ section.title|default:"Employee Benefits" }}</h2>
                          <div class="row">
                              {% for benefit in benefits %}
                                {% if benefit.is_active %}
                                <div class="col-md-4 mb-4">
                                    <div class="text-center">
                                        <div class="feature-icon mx-auto mb-3 bg-primary bg-opacity-10 rounded-circle p-3" style="width: 70px; height: 70px;">
                                            <i data-lucide="{{ benefit.icon_name }}" class="text-primary"></i>
                                        </div>
                                        <h5 class="fw-bold">{{ benefit.title }}</h5>
                                        <p class="text-muted">{{ benefit.description }}</p>
                                    </div>
                                </div>
                                {% endif %}
                              {% endfor %}
                          </div>
                      </div>
                      {% endif %}
                    {% endfor %}
                    
                    <!-- Current Openings -->
                    {% for section in careers_sections %}
                      {% if section.section_type == 'openings' and section.is_active %}
                      <div id="openings" class="mb-5">
                          <h2 class="display-6 fw-bold mb-4 text-center">{{ section.title|default:"Current Openings" }}</h2>
                          <div class="accordion" id="jobOpenings">
                              {% for opening in job_openings %}
                                {% if opening.is_active %}
                                <div class="accordion-item">
                                    <h2 class="accordion-header" id="heading{{ opening.id }}">
                                        <button class="accordion-button fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ opening.id }}">
                                            <i data-lucide="briefcase" class="me-2"></i> {{ opening.title }}
                                        </button>
                                    </h2>
                                    <div id="collapse{{ opening.id }}" class="accordion-collapse collapse {% if forloop.first %}show{% endif %}" data-bs-parent="#jobOpenings">
                                        <div class="accordion-body">
                                            <p><strong>Location:</strong> {{ opening.location }}</p>
                                            <p><strong>Department:</strong> {{ opening.department }}</p>
                                            <h6 class="fw-bold">Job Description:</h6>
                                            <p>{{ opening.description }}</p>
                                            {% if opening.responsibilities %}
                                            <h6 class="fw-bold">Responsibilities:</h6>
                                            <ul>
                                                {% for responsibility in opening.responsibilities|linebreaksbr|split:"<br>" %}
                                                  {% if responsibility %}
                                                  <li>{{ responsibility|safe }}</li>
                                                  {% endif %}
                                                {% endfor %}
                                            </ul>
                                            {% endif %}
                                            {% if opening.requirements %}
                                            <h6 class="fw-bold">Requirements:</h6>
                                            <ul>
                                                {% for requirement in opening.requirements|linebreaksbr|split:"<br>" %}
                                                  {% if requirement %}
                                                  <li>{{ requirement|safe }}</li>
                                                  {% endif %}
                                                {% endfor %}
                                            </ul>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                              {% endfor %}
                          </div>
                      </div>
                      {% endif %}
                    {% endfor %}
                    
                    <!-- Call to Action -->
                    {% for section in careers_sections %}
                      {% if section.section_type == 'cta' and section.is_active %}
                      <div class="text-center mt-5 p-5 bg-primary bg-opacity-10 rounded-3">
                          <h3 class="fw-bold mb-3">{{ section.title|default:"Ready to Join Our Team?" }}</h3>
                          <p class="mb-4">{{ section.subtitle|default:'Send your resume to <a href="mailto:hr@dryfruithouse.com" class="text-primary fw-bold">hr@dryfruithouse.com</a>'|safe }}</p>
                          <a href="mailto:hr@dryfruithouse.com?subject=Career Application" class="btn btn-primary btn-lg">
                              <i data-lucide="send" class="me-2"></i>{{ section.content|default:"Apply Now"|safe }}
                          </a>
                          <div class="mt-4">
                              <p class="mb-1"><i data-lucide="mail" class="me-2"></i>hr@dryfruithouse.com</p>
                              <p class="mb-0"><i data-lucide="phone" class="me-2"></i>+91-8309232756</p>
                          </div>
                      </div>
                      {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize Lucide icons
    lucide.createIcons();
    
    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
});
</script>
{% endblock %}